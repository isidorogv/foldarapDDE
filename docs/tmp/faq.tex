\chapter{Conclusiones}

En este capítulo se presentan las conclusiones a las que se han llegado a lo largo del desarrollo del trabajo y se indican las posibles lineas futuras de investigación/avance.

\section{Conclusiones.}

En el apartado de conclusiones se mencionará que no fue fácil conseguir que Rovio fuese capaz de localizar y seguir un objeto. En primer lugar para que el robot tenga algo a lo que seguir hay que ser capaz de hacer que ese objeto pueda ser percibido. En una imagen tomada por la cámara del robot hay una ingente cantidad de información que necesita ser filtrada y descartada para focalizar la atención en sólo aquello que resulte relevante.\\
\\
Por otro lado, esta separación de lo importante se debe realizar en base a un criterio que sea fiable porque de lo contrario, la separación de la información conducirá a error. Además de esto, existe la posibilidad de que la información recibida contenga perturbaciones o ruido que dificulte aún más la separación y extracción de los datos interesantes. Para salvar esta situación la mejor opción es el \textbf{uso de filtros}. \\
\\
En relación con el filtrado de imágenes, se pudo comprobar que cuanto mejor es el filtrado más fácil resulta extraer información, pero al mismo tiempo, más costoso computacionalmente se vuelve en tiempo y recursos sin garantizar un resultado óptimo al 100 por 100.\\
\\
Una técnica que dio buen resultado en lo que a filtrado se refiere es la del \textbf{filtrado de ruido impulsional} y el \textbf{suavizado de imágenes}. El ruido impulsional, que suele producirse en las ópticas de mala calidad --sensores CCD y/o lentes-- o debido a polvo y suciedad en el objetivo de la cámara, se filtra muy bien mediante el empleo de filtros de mediana que al mismo tiempo que eliminan el ruido, permiten conservar los detalles de la imagen. Por su parte, el ruido gausiano que aparece cuando las condiciones de luz son deficientes al verse afectados el brillo y/o el color de la imagen, se puede eliminar muy bien mediante filtros gausianos, como el empleado en este trabajo.\\
\\
Ambos filtrados están justificados en este trabajo porque por un lado, se tuvo que emplear una cámara de muy baja calidad, ya que Rovio monta una cámara VGA que no ofrece muy buena resolución y que monta un sensor CCD mediocre, de ahí el bajo coste del robot. Por otro lado, las condiciones en las que Rovio podría trabajar variarán en función de la luz ambiente, situación en la que siempre se hace imprescindible un filtro gausiano.\\
\\
Para facilitar aún más el filtrado en estos casos suele ser habitual \textbf{convertir el espacio de color} de la imagen. Por lo general, las cámaras ofrecen una imagen en el espacio de color RGB, es decir, una combinación de los colores básicos de la luz rojo (R - Red), verde (G - Green) y azul (B - Blue). Este espacio de color está muy expuesto a verse afectado por la variaciones de iluminación ya que trabaja directamente con el valor del brillo de los colores. Para evitar esto es bueno convertir el espacio RGB al espacio HSV ya que de esta manera los colores se vuelven mucho más insensibles a variaciones de la iluminación, como se pudo comprobar en este trabajo.\\
\\
La extracción de la información relevante de una imagen es lo que se conoce con el nombre de \textbf{segmentación}. La segmentación se puede realizar mediante el uso de varias técnicas, siendo una de ellas la \textbf{segmentación por umbral de color}. Para aplicar esta técnica basta con fijar un margen de valores de color entre los cuales deseamos encontrar lo que buscamos y descartar el resto de valores. Si, por ejemplo, queremos encontrar una pelota naranja en una imagen, basta con utilizar los valores de color del color naranja para separar la pelota del resto de los objetos de la imagen y obtener un \textbf{blob} o \textbf{segmento} que nos represente a la pelota.\\
\\
Esta es la técnica más simple y fácil de aplicar y que suele dar un resultado aceptable si no se necesita un nivel de exigencia alto. Este nivel vendría impuesto en parte por la calidad de la cámara y por las necesidades de la aplicación a la que fuese destinado. En nuestro caso, la calidad de la cámara no era buena por lo que el nivel de exigencia no podía ser demasiado alto. A esto hay que añadir que seguir a un objeto simple no es un objetivo demasiado exigente como podría ser reconocer un rostro, por lo que la decisión de emplear una segmentación de umbral demostró ser la opción más acertada.\\
\\
Otra de las conclusiones que se han podido sacar del desarrollo de este trabajo es que un buen filtrado y segmentado no siempre producen un único blob o segmento. En ocasiones, después de filtrar y separar los objetos de interés quedan algunos blobs más pequeños que podrían distraer la atención de nuestro robot. Partes de la imagen que caen dentro del margen de color seleccionado y que no han sido filtradas por completo por ser muy grandes o nítidas pueden aparecer en la imagen como blobs secundarios que también es necesario eliminar.\\
\\
Para paliar este problema se hizo necesario emplear operaciones de dilatación y erosión de la imagen. Mediante las erosiones o contracciones, estos blobs secundarios tienden a difuminarse o estrecharse, mientras que las dilataciones o expansiones fueron aplicadas para eliminar los huecos que a veces aparecen dentro de los blobs. Combinando adecuadamente la secuencia y cantidad de estas operaciones se consiguió obtener un segmento o blob bastante exacto a la forma del objeto real a segmentar, en nuestro caso una de las pelotas del laboratorio.\\
\\
Como estas operaciones no son tampoco una panacea y en previsión de que no se pudiera eliminar por completo la presencia de más de un segmento, se optó finalmente por buscar contornos en la imagen. Los contornos permiten encerrar áreas de diferente forma que se encuentran en la imagen y seleccionar aquella que presente el perímetro, superficie o ambos que más se adecúe a nuestras necesidades. De esta manera se pudo obtener un sólo blob en la imagen con el que Rovio pudo calcular el centroide del objeto estímulo para realizar su seguimiento.\\
\\
En cuanto a la parte del seguidor de objetos, lo más difícil fue poder controlar los movimientos de Rovio sin tener posibilidad de aplicar controladores PID. El hardware de Rovio no contempla la posibilidad de realizar este control de manera adecuada y el software es complicado de gestionar para este cometido tal cual viene instalado en el robot.\\
\\
Para finalizar, se menciona que el uso de OpenCV facilitó mucho la labor en lo que a la programación se refiere, ya que la mayor parte de las operaciones de filtrado, segmentación y procesado de imagen fueron simples llamadas a funciones que ya vienen incluidas en la biblioteca, lo cual viene a demostrar la potencia de OpenCV como biblioteca de funciones y por otro lado, lo fácil que puede ser implementar cualquier tipo de acción más compleja simplemente combinando las funciones elementales que se incluyen en ella.

\section{Líneas de trabajo futuras.}

Como línea de trabajo futuro se indica la posibilidad de mejorar el segmentado para hacerlo completamente independiente de la cantidad y calidad de la luz ambiente. El empleo del espacio de color HSV en lugar del RGB para la segmentación hizo posible que fuera más fácil localizar blobs en la imagen en condiciones de luz pobres, pero no era completamente insensible a estos cambios en la iluminación.\\
\\
Dependiendo del número de puntos de luz, del ángulo de incidencia y de lo uniforme o no que ésta sea, se consiguen mejores o peores resultados. Por ejemplo, un único punto de luz produce mucha sombra --tanto propia como arrojada-- en el objeto estímulo y en el resto de la escena, haciendo que los colores que quedan en la cara oscura del objeto tiendan a perder su valor de color. Esto hace que el segmentado no abarque la totalidad del volumen del objeto estímulo produciendo un blob parcial del objeto, es decir un segmento cuya superficie no se corresponde con la superficie que ocupa en la imagen el objeto. Cuanto más uniforme es la luz ambiente, mucho mejor se realiza la segmentación por lo que incluir alguna rutina de calibrado de la cámara --para cámaras \emph{pin hole} que es el tipo de cámara que monta Rovio-- en diferentes condiciones de luz podría resultar en un segmentado mucho más definido, completo y fiable del objeto estímulo.\\
\\
Muy posiblemente un cambio en la técnica de segmentado a emplear podría paliar también este problema en gran medida, ya que como se apuntó en apartados anteriores la técnica del segmentado por umbral de color es la más simple de todas y por tanto, la que peor resultado tiende a ofrecer, habida cuenta del problema de la iluminación descrito anteriormente. Una cámara de mayor calidad también podría contribuir a mejorar el segmentado, aunque a un mayor coste computacional y económico, por lo que no se aconseja. Además, este cambio implicaría una modificación del hardware de Rovio con todo lo que ello supone, a saber, controlador para ese modelo de cámara, recompilado del sistema operativo de Rovio, etc\ldots